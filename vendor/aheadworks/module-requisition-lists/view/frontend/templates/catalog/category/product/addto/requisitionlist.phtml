<?php
// @codingStandardsIgnoreFile

/** @var $block \Magento\Ui\Block\Wrapper */
?>
<?php
    /** @var \Aheadworks\RequisitionLists\ViewModel\Catalog\Product\View\RequisitionListProvider $viewModel */
    $viewModel = $block->getListViewModel();
    $product = $viewModel->getProduct($block->getParentBlock());
    $isAllowed = $viewModel->isAllowedInProductList($product);
?>
<?php if ($isAllowed): ?>
    <div class="aw-rl__list-wrapper category" data-role="aw-rl-listing" data-bind="scope: 'addToProductLink_<?= /* @noEscape */ $product->getSku() ?>'">
        <!-- ko template: getTemplate() --><!-- /ko -->
    </div>
    <script type="text/x-magento-init">
            {
                "*": {
                    "Magento_Ui/js/core/app": {
                        "components": {
                            "addToProductLink_<?= /* @noEscape */ $product->getSku() ?>": {
                                "component": "Aheadworks_RequisitionLists/js/ui/components/requisition-list/catalog-add-to",
                                "urlToRequisitionList": "<?= /* @noEscape */ $viewModel->getUrlToRequisitionListPage() ?>",
                                "addToCartFormSelector": "form[data-role='tocart-form'][data-product-sku='<?= /* @noEscape */ $product->getSku() ?>']",
                                "addToRequisitionListUrl": "<?= /* @noEscape */ $viewModel->getAddToListUrl() ?>",
                                "isLoggined": "<?= /* @noEscape */ $viewModel->isLoggedUserIn() ?>",
                                "productType": "<?= /* @noEscape */ $product->getTypeId() ?>"
                            }
                        }
                    }
                }
            }
    </script>
<?php endif; ?>
